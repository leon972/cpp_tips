<!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #888888">/*</span>
<span style="color: #888888"> Lambda function</span>
<span style="color: #888888"> */</span>

<span style="color: #557799">#include &lt;cstdlib&gt;</span>
<span style="color: #557799">#include &lt;iostream&gt;</span>
<span style="color: #557799">#include &lt;functional&gt;</span>
<span style="color: #557799">#include &lt;vector&gt;</span>
<span style="color: #557799">#include &lt;numeric&gt;</span>

<span style="color: #008800; font-weight: bold">using</span> <span style="color: #008800; font-weight: bold">namespace</span> std;


<span style="color: #888888">/**</span>
<span style="color: #888888"> * Passing lambda to function (by value  this is the preferred way)</span>
<span style="color: #888888"> * @param lambda</span>
<span style="color: #888888"> * @param a operand 1</span>
<span style="color: #888888"> * @param b operand 2</span>
<span style="color: #888888"> */</span>
<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">use_my_lambda</span>(std<span style="color: #333333">::</span>function<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span>(<span style="color: #333399; font-weight: bold">int</span>,<span style="color: #333399; font-weight: bold">int</span>)<span style="color: #333333">&gt;</span> lambda,<span style="color: #333399; font-weight: bold">int</span> a,<span style="color: #333399; font-weight: bold">int</span> b)
{
    cout<span style="color: #333333">&lt;&lt;</span>lambda(a,b)<span style="color: #333333">&lt;&lt;</span>endl;    
}

<span style="color: #888888">/**</span>
<span style="color: #888888"> * Passing lambda using template</span>
<span style="color: #888888"> * @param conv</span>
<span style="color: #888888"> * @return </span>
<span style="color: #888888"> */</span>
<span style="color: #008800; font-weight: bold">template</span> <span style="color: #333333">&lt;</span><span style="color: #008800; font-weight: bold">typename</span> F<span style="color: #333333">&gt;</span>
<span style="color: #333399; font-weight: bold">void</span> use_my_lambda2(F fn,<span style="color: #333399; font-weight: bold">int</span> val)
{
    cout<span style="color: #333333">&lt;&lt;</span>fn(val)<span style="color: #333333">&lt;&lt;</span>endl;
}


<span style="color: #888888">/**</span>
<span style="color: #888888"> * Returning a lambda from function</span>
<span style="color: #888888"> */</span>
std<span style="color: #333333">::</span>function<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">float</span>(<span style="color: #333399; font-weight: bold">float</span>)<span style="color: #333333">&gt;</span> create_conv_fn(<span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">float</span> conv)
{
    <span style="color: #008800; font-weight: bold">return</span> [<span style="color: #333333">=</span>](<span style="color: #333399; font-weight: bold">float</span> value) {<span style="color: #008800; font-weight: bold">return</span> value<span style="color: #333333">*</span>conv;};
}

<span style="color: #888888">/*</span>
<span style="color: #888888"> * </span>
<span style="color: #888888"> */</span>
<span style="color: #333399; font-weight: bold">int</span> main(<span style="color: #333399; font-weight: bold">int</span> argc, <span style="color: #333399; font-weight: bold">char</span><span style="color: #333333">**</span> argv) {
    
    <span style="color: #333399; font-weight: bold">int</span> x<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">99</span>;
    <span style="color: #333399; font-weight: bold">int</span> y<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">0</span>;
    
    <span style="color: #888888">//does not capture anything</span>
    <span style="color: #008800; font-weight: bold">auto</span> print_hello<span style="color: #333333">=</span>[]() {
        cout<span style="color: #333333">&lt;&lt;</span><span style="background-color: #fff0f0">&quot;hello!&quot;</span><span style="color: #333333">&lt;&lt;</span>endl;
    }; 
    
    print_hello(); <span style="color: #888888">//prints hello</span>
    
    <span style="color: #888888">//capture everything in scope by reference    </span>
    <span style="color: #008800; font-weight: bold">auto</span> inc_x<span style="color: #333333">=</span>[<span style="color: #333333">&amp;</span>](<span style="color: #333399; font-weight: bold">int</span> delta) {
        x<span style="color: #333333">+=</span>delta;
    };
    
    inc_x(<span style="color: #0000DD; font-weight: bold">2</span>); <span style="color: #888888">//x=101</span>
    cout<span style="color: #333333">&lt;&lt;</span>x<span style="color: #333333">&lt;&lt;</span>endl;
    
    <span style="color: #888888">//capture everything in scope by copy</span>
    std<span style="color: #333333">::</span>function<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">void</span>(<span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">char</span><span style="color: #333333">*</span>)<span style="color: #333333">&gt;</span> fn<span style="color: #333333">=</span>[<span style="color: #333333">=</span>](<span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">char</span> <span style="color: #333333">*</span>msg)
    {
        cout<span style="color: #333333">&lt;&lt;</span>msg<span style="color: #333333">&lt;&lt;</span>endl;        
        cout<span style="color: #333333">&lt;&lt;</span>x<span style="color: #333333">&lt;&lt;</span>endl;
        <span style="color: #888888">//x++; error x is readonly here            </span>
    };  
    
    fn(<span style="background-color: #fff0f0">&quot;capture by copy&quot;</span>);
    cout<span style="color: #333333">&lt;&lt;</span><span style="background-color: #fff0f0">&quot;x after call=&quot;</span><span style="color: #333333">&lt;&lt;</span>x<span style="color: #333333">&lt;&lt;</span>endl;    
    
    <span style="color: #888888">//lambda returing values</span>
    <span style="color: #008800; font-weight: bold">auto</span> sum<span style="color: #333333">=</span>[](<span style="color: #333399; font-weight: bold">int</span> a,<span style="color: #333399; font-weight: bold">int</span> b)
    {
        <span style="color: #008800; font-weight: bold">return</span> a<span style="color: #333333">+</span>b;
    };
    
    cout<span style="color: #333333">&lt;&lt;</span>sum(<span style="color: #0000DD; font-weight: bold">11</span>,<span style="color: #0000DD; font-weight: bold">22</span>)<span style="color: #333333">&lt;&lt;</span>endl;
    
    <span style="color: #888888">//lambda specifying return value</span>
    <span style="color: #008800; font-weight: bold">auto</span> sum2<span style="color: #333333">=</span>[](<span style="color: #333399; font-weight: bold">int</span> a,<span style="color: #333399; font-weight: bold">int</span> b)<span style="color: #333333">-&gt;</span><span style="color: #333399; font-weight: bold">int</span>
    {
        <span style="color: #008800; font-weight: bold">return</span> a<span style="color: #333333">+</span>b;
    };    
    
    
    <span style="color: #888888">//use lambda</span>
    use_my_lambda(sum,<span style="color: #0000DD; font-weight: bold">1</span>,<span style="color: #0000DD; font-weight: bold">2</span>); <span style="color: #888888">//prints 3</span>
    
    use_my_lambda([](<span style="color: #333399; font-weight: bold">int</span> a,<span style="color: #333399; font-weight: bold">int</span> b){<span style="color: #008800; font-weight: bold">return</span> a<span style="color: #333333">*</span>b;},<span style="color: #0000DD; font-weight: bold">6</span>,<span style="color: #0000DD; font-weight: bold">7</span>); <span style="color: #888888">//prints 42</span>
    
    <span style="color: #888888">//create lambda</span>
    <span style="color: #008800; font-weight: bold">auto</span> deg_to_rad<span style="color: #333333">=</span>create_conv_fn(<span style="color: #6600EE; font-weight: bold">3.1415927f</span><span style="color: #333333">/</span><span style="color: #6600EE; font-weight: bold">180.0f</span>);
    
    cout<span style="color: #333333">&lt;&lt;</span>deg_to_rad(<span style="color: #6600EE; font-weight: bold">90.0f</span>)<span style="color: #333333">&lt;&lt;</span>endl; <span style="color: #888888">//1.507</span>
    
    <span style="color: #888888">//captures only x by value</span>
    <span style="color: #008800; font-weight: bold">auto</span> fn3<span style="color: #333333">=</span>[x](<span style="color: #333399; font-weight: bold">int</span> a)<span style="color: #333333">-&gt;</span><span style="color: #333399; font-weight: bold">int</span> {
        <span style="color: #008800; font-weight: bold">return</span> x<span style="color: #333333">+</span>a;
    };
    
    cout<span style="color: #333333">&lt;&lt;</span>fn3(<span style="color: #0000DD; font-weight: bold">11</span>)<span style="color: #333333">&lt;&lt;</span>endl; <span style="color: #888888">//112</span>
    
    <span style="color: #888888">//captures everything by reference except x that is by value</span>
    <span style="color: #008800; font-weight: bold">auto</span> fn4<span style="color: #333333">=</span>[<span style="color: #333333">&amp;</span>,x]() <span style="color: #333333">-&gt;</span><span style="color: #333399; font-weight: bold">int</span> {
        <span style="color: #333333">++</span>y;
        <span style="color: #008800; font-weight: bold">return</span> x<span style="color: #333333">+</span>y;
    };
    
    cout<span style="color: #333333">&lt;&lt;</span>fn4()<span style="color: #333333">&lt;&lt;</span>endl;
    
    use_my_lambda2(fn3,<span style="color: #0000DD; font-weight: bold">1003</span>); <span style="color: #888888">//1104</span>
    
    use_my_lambda2([](<span style="color: #333399; font-weight: bold">int</span> t){<span style="color: #008800; font-weight: bold">return</span> t<span style="color: #333333">*</span>t;},<span style="color: #0000DD; font-weight: bold">9</span>); <span style="color: #888888">//81</span>
    
    <span style="color: #888888">//generic lambda (since C++14)</span>
    <span style="color: #008800; font-weight: bold">auto</span> genfn<span style="color: #333333">=</span>[](<span style="color: #008800; font-weight: bold">auto</span> a,<span style="color: #008800; font-weight: bold">auto</span> b,<span style="color: #008800; font-weight: bold">auto</span> c) {
        <span style="color: #008800; font-weight: bold">return</span> a<span style="color: #333333">*</span>b<span style="color: #333333">/</span>c;
    };
    
    cout<span style="color: #333333">&lt;&lt;</span>genfn(<span style="color: #6600EE; font-weight: bold">4.2</span>,<span style="color: #6600EE; font-weight: bold">2.1</span>,<span style="color: #0000DD; font-weight: bold">2</span>)<span style="color: #333333">&lt;&lt;</span>endl;
    
    <span style="color: #008800; font-weight: bold">auto</span> sumfn<span style="color: #333333">=</span>[](<span style="color: #008800; font-weight: bold">auto</span> a,<span style="color: #008800; font-weight: bold">auto</span> b){
        <span style="color: #008800; font-weight: bold">return</span> a<span style="color: #333333">+</span>b;
    };
    
    <span style="color: #888888">//template lmabda (since C++20)</span>
    <span style="color: #008800; font-weight: bold">auto</span> fnt<span style="color: #333333">=</span>[sumfn]<span style="color: #333333">&lt;</span><span style="color: #008800; font-weight: bold">typename</span> T<span style="color: #333333">&gt;</span>(<span style="color: #008800; font-weight: bold">const</span> std<span style="color: #333333">::</span>vector<span style="color: #333333">&lt;</span>T<span style="color: #333333">&gt;</span> <span style="color: #333333">&amp;</span>vec) {
        <span style="color: #008800; font-weight: bold">return</span> std<span style="color: #333333">::</span>accumulate(vec.begin(),vec.end(),T{},sumfn);
    };
    
    std<span style="color: #333333">::</span>vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> vec{<span style="color: #0000DD; font-weight: bold">1</span>,<span style="color: #0000DD; font-weight: bold">2</span>,<span style="color: #0000DD; font-weight: bold">3</span>}; <span style="color: #888888">//prints 6</span>
    cout<span style="color: #333333">&lt;&lt;</span>fnt(vec)<span style="color: #333333">&lt;&lt;</span>endl;
    
    <span style="color: #008800; font-weight: bold">return</span> <span style="color: #0000DD; font-weight: bold">0</span>;
}
</pre></div>

